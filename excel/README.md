# Excel 测试数据集

## 概述

本数据集包含多个 Excel (.xlsx) 和 CSV 文件，涵盖人力资源、经济、销售、教育、社交媒体、股票交易等领域，旨在支持数据分析技能的测试与练习。每个文件关联分析任务，包括增删改查、统计汇总、筛选、排序、画图、分组聚合、时间序列分析以及两表联查，适合学习数据处理和商业洞察。

## 目录

- [数据集结构](#数据集结构)
- [领域分布](#领域分布)
- [测试维度分析](#测试维度分析)
- [数据特点](#数据特点)

## 数据集结构

数据集包含 Excel 文件（如 1-2.xlsx、1-3.xlsx）和 CSV 文件（如 29ba53ce7ca43a979263ed36798f62a3.csv），关联四个 JSON 文件：

- **data_draw.json**: 50 条指令，针对画图类问题。
- **data_crud.json**: 40 条指令，涵盖增删改查任务。
- **data_query.json**: 280 条指令，聚焦查询、统计及多表联查任务。
- **data_analysis.json**: 836 条指令，针对 CSV 文件的统计分析。

每条指令包括：
- **id**：唯一标识符。
- **question**：任务描述（中文或英文），明确数据分析目标。
- **concepts**：操作类型（如 增加、删除、Filtering、Summary Statistics、Join）。
- **file_name**：关联的 Excel 文件名（可能包含多文件，如多表联查场景）。
- **answer**：标准答案，部分要求格式（如 "Final Answer: ..."）。

## 领域分布

数据集覆盖多个领域，示例文件如下：

| 领域                     | 示例文件                           |
|--------------------------|------------------------------------|
| 员工与人力资源数据       | 1-2.xlsx, 3-5.xlsx                |
| 销售与订单数据           | 1-4.xlsx, 4-9.xlsx                |
| 经济与消费数据           | 1-1.xlsx                          |
| 客户与市场数据           | 2-6.xlsx                          |
| 股票与金融数据           | 5-2.xlsx                          |
| 教育与学生数据           | 2-2.xlsx, 3-3.xlsx                |
| 社会与文化数据           | Titanic.xlsx, 2015–2019.xlsx      |
| 资产与采购数据           | 1-5.xlsx, 4-3.xlsx                |
| 食品与农业数据           | winequality-red.xlsx              |
| 会议与预约数据           | 2-7.xlsx, 4-5.xlsx                |
| 物流与运输数据           | 1-9.xlsx, 4-4.xlsx                |
| 房地产数据               | boston.xlsx, 4-7.xlsx             |
| 健康与医疗数据           | 4-5.xlsx                          |
| 气象与运输数据           | 29ba53ce7ca43a979263ed36798f62a3.csv |

## 测试维度分析

### 1. 操作类型分布

基于 JSON 文件的 `concepts`，结合增删改及两表联查具体数量：

| 操作类型       | 指令数量 | 占比 (%) |
|----------------|----------|----------|
| 查 (Read, including Join) | 280 | 21.42% |
| 数据分析       | 836      | 64.00%  |
| 增 (Create)    | 7        | 0.54%   |
| 删 (Delete)    | 7        | 0.54%   |
| 改 (Update)    | 4        | 0.31%   |
| 画图 (Draw)    | 50       | 3.83%   |

**注**: “查”包含传统查询（筛选、统计、排序）及两表联查（Join）操作，其中两表联查占比约 14.29%（40/280），反映多表复杂性。

![](./png/chart.png)

- **查 (including Join)**: 包括筛选、统计、排序及两表联查，测试查询和多表操作能力。
- **数据分析**: 复杂统计、相关性、分组等，占比最高，测试分析能力。
- **增**: 插入新数据（如添加员工、地区），占比低。
- **删**: 删除特定数据（如删除低评分记录），占比低。
- **改**: 修改数据（如更新薪资、GDP），占比最低。
- **画图**: 根据数据画图。

### 2. 具体操作细分

| 具体操作            | 指令数量 | 占比 (%) |
|---------------------|----------|----------|
| Summary Statistics  | ~300     | ~23.08%  |
| Filtering           | ~200     | ~15.38%  |
| Max/Min/Lookup      | ~150     | ~11.54%  |
| Aggregation/Sum     | ~100     | ~7.69%   |
| Count               | ~80      | ~6.15%   |
| GroupBy             | ~50      | ~3.85%   |
| Distribution/Binning | ~40      | ~3.08%   |
| Correlation         | ~20      | ~1.54%   |
| Time Series         | ~15      | ~1.15%   |
| Join/Multi-table Operations | 40 | ~3.08% |
| Data Insertion      | 7        | 0.54%    |
| Data Deletion       | 7        | 0.54%    |
| Data Modification   | 4        | 0.31%    |

**注**: “Join/Multi-table Operations”指两表联查任务，涉及多表关联和聚合操作，新增 40 条，占比约 3.08%，体现复杂性。

![](./png/chart%20(1).png)

- **Summary Statistics**: 如平均值、中位数，占比高，反映基础统计分析需求。
- **Filtering**: 筛选特定条件的数据，测试条件查询能力。
- **Max/Min/Lookup**: 查找最大/最小值或对应记录，常见于排行榜场景。
- **Aggregation/Sum**: 求和操作，常见于财务、库存等场景。
- **GroupBy**: 按类别汇总，如班级成绩。
- **Distribution/Binning**: 分箱统计，测试数据分布分析能力。
- **Correlation**: 相关性分析，较少但难度较高，测试高级统计能力。
- **Time Series**: 时间序列分析，测试动态数据处理能力。
- **Join/Multi-table Operations**: 两表或多表联查（如部门与员工表关联、订单与客户表聚合），新增 40 条，强调多表复杂性和聚合能力。
- **Data Insertion/Deletion/Modification**: 增删改操作，占比低但考验数据管理技能。

### 3. 难度等级分布

基于问题设计，难度根据操作的复杂性判断：

| 难度等级 | 指令数量 | 占比 (%) |
|----------|----------|----------|
| Easy     | ~580     | ~44.44%  |
| Medium   | ~420     | ~32.19%  |
| Hard     | ~200     | ~15.33%  |

**注**: 总指令数为 1300（50 + 40 + 280 + 836），两表联查任务（40 条）主要归类为 Hard，部分为 Medium。

![](./png/chart%20(2).png)

- **Easy**: 简单统计、计数、单条件筛选（如平均薪资、GDP 低于 10000 的地区数），通常涉及一个数据表，1-2 步即可完成，适合初学者。
- **Medium**: 分组、排序、时间序列、组合条件筛选（如按部门汇总薪资、GDP 增长率），通常涉及一个数据表，或简单两表联查，需要 3-5 步操作，适合中级用户。
- **Hard**: 涉及多表关联（Join）、复杂嵌套操作（如多表聚合、增删改后验证）、相关性分析等，通常需要 6 步或更复杂的操作，测试高级技能，其中两表联查占显著比例。

## 数据特点

- **格式**: Excel (.xlsx) 和 CSV，适合 pandas、Excel 处理。
- **多样性**: 覆盖人力资源、经济、销售、教育等场景。
- **任务类型**: 增删改查、统计、筛选、排序、分组、时间序列、两表联查。
- **复杂性**: 含多表结构、缺失值，考验数据清洗和多表关联能力。
- **答案规范**: `data_analysis.json` 要求 "Final Answer: ..." 格式。
