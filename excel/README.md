# Excel 测试数据集

## 概述

本数据集包含 **63 个 Excel 文件**，涵盖经济、人力资源、销售、教育、金融等多个领域，旨在支持数据分析技能的测试与练习。每个文件关联一个或多个分析任务，包括统计汇总、数据筛选、分组聚合、相关性分析和时间序列分析，适用于学习数据处理、统计分析和商业洞察。

## 目录

- [数据集结构](#数据集结构)
- [领域分布](#领域分布)
- [测试维度分析](#测试维度分析)
- [数据特点](#数据特点)

## 数据集结构

`question.json` 文件包含 278 条指令，每条指令具有以下字段：

- **id**：唯一标识符。
- **question**：任务描述（中文），明确数据分析目标。
- **concepts**：涉及的数据操作或统计概念（如“Summary Statistics”、“Filtering”、“Correlation”）。
- **constraints**：任务要求，包括使用 pandas、目标列、数据处理规则（如保留两位小数）等。
- **format**：输出格式要求，如 `@key[value]` 或 `@key[{key1:value1, key2:value2}]`。
- **file_name**：关联的 Excel 文件名。
- **level**：难度等级（“easy”、“medium”、“hard”）。

每个指令配有 **3 个测试用例**，采用 Online Judge (OJ) 风格评估，确保结果的准确性和格式一致性。

## 领域分布

数据集分为 **14 个领域**，按文件数量比例降序排列：

| 领域                     | 文件数 | 比例 (%) | 示例文件                           |
|--------------------------|--------|----------|-----------------------------------|
| 员工与人力资源数据       | 8      | 20.00    | 1-2.xlsx, 3-5.xlsx               |
| 销售与订单数据           | 6      | 15.00    | 1-4.xlsx, 4-9.xlsx               |
| 经济与消费数据           | 5      | 12.00    | 1-1.xlsx, avocado.xlsx           |
| 客户与市场数据           | 5      | 12.00    | 2-6.xlsx, bank-additional-full.xlsx |
| 股票与金融数据           | 5      | 12.00    | Apple.xlsx, 5-2.xlsx             |
| 教育与学生数据           | 4      | 10.00    | 2-2.xlsx, 3-3.xlsx               |
| 社会与文化数据           | 4      | 10.00    | Titanic.xlsx, 2015–2019.xlsx     |
| 资产与采购数据           | 3      | 7.00     | 1-5.xlsx, 4-3.xlsx               |
| 食品与农业数据           | 2      | 5.00     | winequality-red.xlsx             |
| 会议与预约数据           | 2      | 5.00     | 2-7.xlsx, 4-5.xlsx               |
| 物流与运输数据           | 2      | 5.00     | 1-9.xlsx, 4-4.xlsx               |
| 出版与媒体数据           | 2      | 5.00     | bestsellers-with-categories.xlsx |
| 房地产数据               | 2      | 5.00     | boston.xlsx, 4-7.xlsx           |
| 健康与医疗数据           | 1      | 2.00     | 4-5.xlsx                        |

**注**：为避免重复计数，`avocado.xlsx` 归入“经济与消费数据”，`WorldCupMatches.xlsx`、`WorldCups.xlsx` 和 `WorldCupPlayers.xlsx` 归入“社会与文化数据”，因此“体育与娱乐数据”比例为 0%。

## 测试维度分析

数据集包含多种操作类型和测试维度，以下是对 278 条指令的详细分析：

### 1. 操作类型分布

根据指令的 `concepts` 字段，我们将操作类型分为 **增、删、改、查** 及其他统计操作，统计如下：

| 操作类型 | 指令数量 | 占比 (%) |
| --- | --- | --- |
| 增 (Create) | 3 | 1.08% |
| 删 (Delete) | 22 | 7.91% |
| 改 (Update) | 22 | 7.91% |
| 查 (Read) | 231 | 83.09% |

[难度等级分布](https://raw.githubusercontent.com/MoziaVerse/Datasets/main/excel/png/chart%20(2).png)

- **增（Create）**：包括插入新记录（如员工、反馈），占比低，反映真实场景中数据插入需求较少。
- **删（Delete）**：涉及删除特定条件的数据（如删除低评分记录），占比适中，测试数据清洗能力。
- **改（Update）**：修改现有数据（如更新工资、订单金额），占比与删除相当，测试数据更新能力。
- **查（Read）**：包括查询、统计、聚合、分组等操作，占比最高，反映电子表格分析的核心需求。

### 2. 具体操作细分

基于 `concepts` 字段，进一步细分操作类型：

| 具体操作 | 指令数量 | 占比 (%) |
| --- | --- | --- |
| Summary Statistics | 82 | 29.50% |
| Filtering | 62 | 22.30% |
| Max/Min/Lookup | 46 | 16.55% |
| Aggregation/Sum | 30 | 10.79% |
| Count | 28 | 10.07% |
| Distribution/Binning | 13 | 4.68% |
| Correlation | 6 | 2.16% |
| GroupBy | 16 | 5.76% |
| Proportion | 10 | 3.60% |
| Data Insertion | 3 | 1.08% |
| Data Deletion | 22 | 7.91% |
| Data Modification | 22 | 7.91% |
| Time Series | 5 | 1.80% |

- **Summary Statistics**：如平均值、中位数，占比最高，反映基础统计分析需求。
- **Filtering**：筛选特定条件的数据，占比高，测试条件查询能力。
- **Max/Min/Lookup**：查找最大/最小值或对应记录，常见于排行榜场景。
- **Aggregation/Sum**：求和操作，常见于财务、库存等场景。
- **Distribution/Binning**：分箱统计，测试数据分布分析能力。
- **Correlation**：相关性分析，较少但难度较高，测试高级统计能力。

### 3. 难度等级分布

根据 `level` 字段，指令难度分布如下：

| 难度等级 | 指令数量 | 占比 (%) |
| --- | --- | --- |
| Easy | 152 | 54.68% |
| Medium | 121 | 43.53% |
| Hard | 5 | 1.80% |

- **Easy**：以简单统计、计数、最大/最小值查找为主，适合初学者。
- **Medium**：涉及分组、过滤、时间序列等复杂操作，适合中级用户。
- **Hard**：包括复杂数据修改、跨文件操作，测试高级数据处理能力。


## 数据特点

- **格式**: 所有数据集为 Excel 文件（.xlsx），以表格形式组织，适合 pandas 处理。
- **内容多样性**: 涵盖 14 个领域，涉及经济、人力、销售、教育、金融等。
- **任务复杂度**: 包括简单统计（均值、计数）、分组聚合、相关性分析、时间序列分析等。
- **多样化操作**：涵盖增、删、改、查及统计分析，测试全面的数据处理能力。
- **复杂表格结构**：Excel 文件包含多表、非标准格式、缺失值等，考验数据清洗能力。
- **高指令复杂性**：指令描述详细，包含约束和格式要求，测试代码规范性。
